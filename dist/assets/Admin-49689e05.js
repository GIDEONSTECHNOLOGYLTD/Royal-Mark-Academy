import{r as a,u as O,Q as F,y as T,S as $,i as P,T as _,s as B,U as G,V as M,x as U,z as I,W as q,C as L,X as V,H as z,v as H,M as J,o as W,Y as Q}from"./index-844e9f56.js";function X({userRole:o}){const[d,N]=a.useState([]),[h,u]=a.useState(!0),[l,r]=a.useState(""),[t,n]=a.useState(null),[i,m]=a.useState(!1),[b,g]=a.useState(!1),[S,w]=a.useState(""),[E,C]=a.useState("applicationDate"),[c,f]=a.useState("desc");a.useEffect(()=>{(async()=>{try{const R=await(await fetch("/api/admin/applications",{credentials:"include"})).json();R.success?N(R.data):r(R.message||"Failed to fetch applications")}catch(p){console.error("Error fetching applications:",p),r("Failed to connect to the server")}finally{u(!1)}})()},[]);const x=async(e,p)=>{if(o==="admin")try{g(!0);const k=await(await fetch(`/api/admin/applications/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:p}),credentials:"include"})).json();k.success?(N(d.map(D=>D._id===e?{...D,status:p}:D)),t&&t._id===e&&n({...t,status:p})):r(k.message||"Failed to update application status")}catch(R){console.error("Error updating application status:",R),r("Failed to connect to the server")}finally{g(!1)}},v=e=>{n(e),m(!0)},j=e=>{E===e?f(c==="asc"?"desc":"asc"):(C(e),f("asc"))},A=d.filter(e=>[e.firstName,e.lastName,e.email,e.gradeApplying,e.parentName].join(" ").toLowerCase().includes(S.toLowerCase())).sort((e,p)=>{let R=e[E],k=p[E];return E==="applicationDate"&&(R=new Date(R),k=new Date(k)),c==="asc"?R>k?1:-1:R<k?1:-1}),s=e=>new Date(e).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"}),y=({status:e})=>{switch(e){case"pending":return React.createElement("span",{className:"px-2 py-1 text-xs rounded bg-yellow-100 text-yellow-800 flex items-center"},React.createElement(T,{className:"mr-1"})," Pending");case"reviewed":return React.createElement("span",{className:"px-2 py-1 text-xs rounded bg-blue-100 text-blue-800 flex items-center"},React.createElement($,{className:"mr-1"})," Reviewed");case"accepted":return React.createElement("span",{className:"px-2 py-1 text-xs rounded bg-green-100 text-green-800 flex items-center"},React.createElement(P,{className:"mr-1"})," Accepted");case"rejected":return React.createElement("span",{className:"px-2 py-1 text-xs rounded bg-red-100 text-red-800 flex items-center"},React.createElement(_,{className:"mr-1"})," Rejected");default:return React.createElement("span",{className:"px-2 py-1 text-xs rounded bg-gray-100 text-gray-800"},e)}};return h?React.createElement("div",{className:"flex justify-center items-center py-10"},React.createElement("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-800"})):l?React.createElement("div",{className:"bg-red-50 border-l-4 border-red-500 p-4"},React.createElement("p",{className:"text-red-700"},l)):React.createElement("div",null,React.createElement("div",{className:"flex justify-between items-center mb-6"},React.createElement("h2",{className:"text-xl font-bold text-gray-800"},"Student Applications"),React.createElement("div",{className:"relative"},React.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},React.createElement(O,{className:"h-4 w-4 text-gray-400"})),React.createElement("input",{type:"text",placeholder:"Search applications...",value:S,onChange:e=>w(e.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}))),d.length===0?React.createElement("div",{className:"bg-gray-50 p-6 text-center border rounded-lg"},React.createElement("p",{className:"text-gray-600"},"No applications found.")):React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"min-w-full divide-y divide-gray-200"},React.createElement("thead",{className:"bg-gray-50"},React.createElement("tr",null,React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("applicationDate")},React.createElement("div",{className:"flex items-center"},"Date",E==="applicationDate"&&React.createElement(F,{className:"ml-1"}))),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>j("lastName")},React.createElement("div",{className:"flex items-center"},"Student Name",E==="lastName"&&React.createElement(F,{className:"ml-1"}))),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Grade"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Parent/Guardian"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),React.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},A.map(e=>React.createElement("tr",{key:e._id,className:"hover:bg-gray-50"},React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500"},s(e.applicationDate)),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap"},React.createElement("div",{className:"text-sm font-medium text-gray-900"},e.firstName," ",e.lastName),React.createElement("div",{className:"text-xs text-gray-500"},e.email)),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500"},e.gradeApplying),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500"},e.parentName),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap"},React.createElement(y,{status:e.status})),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium"},React.createElement("button",{onClick:()=>v(e),className:"text-blue-600 hover:text-blue-800 mr-2"},"View Details"))))))),i&&t&&React.createElement("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},React.createElement("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},React.createElement("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:()=>m(!1)}),React.createElement("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​"),React.createElement("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-2xl sm:w-full"},React.createElement("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},React.createElement("div",{className:"sm:flex sm:items-start"},React.createElement("div",{className:"mt-3 text-center sm:mt-0 sm:text-left w-full"},React.createElement("div",{className:"flex justify-between items-center"},React.createElement("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},"Application Details"),React.createElement(y,{status:t.status})),React.createElement("div",{className:"mt-4 grid grid-cols-1 sm:grid-cols-2 gap-4"},React.createElement("div",null,React.createElement("h4",{className:"text-sm font-medium text-gray-500"},"Student Information"),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Name:")," ",t.firstName," ",t.lastName),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Date of Birth:")," ",t.dob?s(t.dob):"Not provided"),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Grade Applying For:")," ",t.gradeApplying),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Current School:")," ",t.currentSchool||"Not provided")),React.createElement("div",null,React.createElement("h4",{className:"text-sm font-medium text-gray-500"},"Parent/Guardian Information"),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Name:")," ",t.parentName),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Email:")," ",t.email),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Phone:")," ",t.phone),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},React.createElement("span",{className:"font-medium"},"Address:")," ",t.address||"Not provided"))),React.createElement("div",{className:"mt-4"},React.createElement("h4",{className:"text-sm font-medium text-gray-500"},"Additional Information"),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},t.message||"No additional information provided.")),React.createElement("div",{className:"mt-4"},React.createElement("h4",{className:"text-sm font-medium text-gray-500"},"Application Submitted"),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},s(t.applicationDate)," at ",new Date(t.applicationDate).toLocaleTimeString())),o==="admin"&&React.createElement("div",{className:"mt-6 bg-gray-50 p-4 rounded-lg"},React.createElement("h4",{className:"text-sm font-medium text-gray-700 mb-2"},"Update Application Status"),React.createElement("div",{className:"flex flex-wrap gap-2"},React.createElement("button",{onClick:()=>x(t._id,"pending"),disabled:t.status==="pending"||b,className:`px-3 py-1 text-xs rounded-md flex items-center ${t.status==="pending"?"bg-yellow-100 text-yellow-800 cursor-default":"bg-yellow-500 text-white hover:bg-yellow-600"} disabled:opacity-50 disabled:cursor-not-allowed`},React.createElement(T,{className:"mr-1"})," Mark Pending"),React.createElement("button",{onClick:()=>x(t._id,"reviewed"),disabled:t.status==="reviewed"||b,className:`px-3 py-1 text-xs rounded-md flex items-center ${t.status==="reviewed"?"bg-blue-100 text-blue-800 cursor-default":"bg-blue-500 text-white hover:bg-blue-600"} disabled:opacity-50 disabled:cursor-not-allowed`},React.createElement($,{className:"mr-1"})," Mark Reviewed"),React.createElement("button",{onClick:()=>x(t._id,"accepted"),disabled:t.status==="accepted"||b,className:`px-3 py-1 text-xs rounded-md flex items-center ${t.status==="accepted"?"bg-green-100 text-green-800 cursor-default":"bg-green-500 text-white hover:bg-green-600"} disabled:opacity-50 disabled:cursor-not-allowed`},React.createElement(P,{className:"mr-1"})," Accept"),React.createElement("button",{onClick:()=>x(t._id,"rejected"),disabled:t.status==="rejected"||b,className:`px-3 py-1 text-xs rounded-md flex items-center ${t.status==="rejected"?"bg-red-100 text-red-800 cursor-default":"bg-red-500 text-white hover:bg-red-600"} disabled:opacity-50 disabled:cursor-not-allowed`},React.createElement(_,{className:"mr-1"})," Reject")))))),React.createElement("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},React.createElement("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:()=>m(!1)},"Close"),React.createElement("button",{type:"button",className:"mt-3 mr-2 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:()=>window.print()},React.createElement(B,{className:"mr-2"})," Export"))))))}function Y(){const[o,d]=a.useState([]),[N,h]=a.useState(!0),[u,l]=a.useState(""),[r,t]=a.useState(null),[n,i]=a.useState(!1),[m,b]=a.useState(""),[g,S]=a.useState("date"),[w,E]=a.useState("desc"),[C,c]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const e=await(await fetch("/api/admin/contacts",{credentials:"include"})).json();e.success?d(e.data):l(e.message||"Failed to fetch contacts")}catch(y){console.error("Error fetching contacts:",y),l("Failed to connect to the server")}finally{h(!1)}})()},[]);const f=async s=>{try{c(!0);const e=await(await fetch(`/api/admin/contacts/${s}/respond`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include"})).json();e.success?(d(o.map(p=>p._id===s?{...p,responded:!0}:p)),r&&r._id===s&&t({...r,responded:!0})):l(e.message||"Failed to update contact")}catch(y){console.error("Error updating contact:",y),l("Failed to connect to the server")}finally{c(!1)}},x=s=>{t(s),i(!0)},v=s=>{g===s?E(w==="asc"?"desc":"asc"):(S(s),E("asc"))},j=o.filter(s=>[s.name,s.email,s.subject,s.message].join(" ").toLowerCase().includes(m.toLowerCase())).sort((s,y)=>{let e=s[g],p=y[g];return g==="date"&&(e=new Date(e),p=new Date(p)),w==="asc"?e>p?1:-1:e<p?1:-1}),A=s=>new Date(s).toLocaleDateString("en-GB",{day:"2-digit",month:"short",year:"numeric"});return N?React.createElement("div",{className:"flex justify-center items-center py-10"},React.createElement("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-800"})):u?React.createElement("div",{className:"bg-red-50 border-l-4 border-red-500 p-4"},React.createElement("p",{className:"text-red-700"},u)):React.createElement("div",null,React.createElement("div",{className:"flex justify-between items-center mb-6"},React.createElement("h2",{className:"text-xl font-bold text-gray-800"},"Contact Messages"),React.createElement("div",{className:"relative"},React.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},React.createElement(O,{className:"h-4 w-4 text-gray-400"})),React.createElement("input",{type:"text",placeholder:"Search messages...",value:m,onChange:s=>b(s.target.value),className:"pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm"}))),o.length===0?React.createElement("div",{className:"bg-gray-50 p-6 text-center border rounded-lg"},React.createElement("p",{className:"text-gray-600"},"No contact messages found.")):React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"min-w-full divide-y divide-gray-200"},React.createElement("thead",{className:"bg-gray-50"},React.createElement("tr",null,React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>v("date")},React.createElement("div",{className:"flex items-center"},"Date",g==="date"&&React.createElement(F,{className:"ml-1"}))),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>v("name")},React.createElement("div",{className:"flex items-center"},"From",g==="name"&&React.createElement(F,{className:"ml-1"}))),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider cursor-pointer",onClick:()=>v("subject")},React.createElement("div",{className:"flex items-center"},"Subject",g==="subject"&&React.createElement(F,{className:"ml-1"}))),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Status"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),React.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},j.map(s=>React.createElement("tr",{key:s._id,className:`hover:bg-gray-50 ${s.responded?"":"font-semibold"}`},React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500"},A(s.date)),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap"},React.createElement("div",{className:"text-sm font-inherit text-gray-900"},s.name),React.createElement("div",{className:"text-xs text-gray-500"},s.email)),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-900"},s.subject),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap"},s.responded?React.createElement("span",{className:"px-2 py-1 text-xs rounded bg-green-100 text-green-800 flex items-center"},React.createElement(G,{className:"mr-1"})," Responded"):React.createElement("span",{className:"px-2 py-1 text-xs rounded bg-yellow-100 text-yellow-800 flex items-center"},React.createElement(M,{className:"mr-1"})," Awaiting Response")),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium"},React.createElement("button",{onClick:()=>x(s),className:"text-blue-600 hover:text-blue-800 mr-2"},"View Details"))))))),n&&r&&React.createElement("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},React.createElement("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},React.createElement("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:()=>i(!1)}),React.createElement("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​"),React.createElement("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},React.createElement("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},React.createElement("div",{className:"sm:flex sm:items-start"},React.createElement("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-blue-100 sm:mx-0 sm:h-10 sm:w-10"},React.createElement(U,{className:"h-6 w-6 text-blue-600"})),React.createElement("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left w-full"},React.createElement("h3",{className:"text-lg leading-6 font-medium text-gray-900",id:"modal-title"},"Message from ",r.name),React.createElement("div",{className:"mt-4"},React.createElement("p",{className:"text-sm text-gray-500"},React.createElement("strong",null,"Email:")," ",r.email),React.createElement("p",{className:"text-sm text-gray-500"},React.createElement("strong",null,"Sent on:")," ",A(r.date)," at ",new Date(r.date).toLocaleTimeString()),React.createElement("p",{className:"text-sm text-gray-500"},React.createElement("strong",null,"Status:")," ",r.responded?"Responded":"Awaiting Response")),React.createElement("div",{className:"mt-4"},React.createElement("h4",{className:"text-md font-medium text-gray-700"},"Subject"),React.createElement("p",{className:"mt-1 text-sm text-gray-900"},r.subject)),React.createElement("div",{className:"mt-4"},React.createElement("h4",{className:"text-md font-medium text-gray-700"},"Message"),React.createElement("div",{className:"mt-1 p-3 bg-gray-50 rounded-md"},React.createElement("p",{className:"text-sm text-gray-900 whitespace-pre-wrap"},r.message))),!r.responded&&React.createElement("div",{className:"mt-6"},React.createElement("button",{onClick:()=>f(r._id),disabled:C,className:"w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:w-auto sm:text-sm"},C?React.createElement(React.Fragment,null,React.createElement("span",{className:"animate-spin mr-2"},"⟳")," Updating..."):React.createElement(React.Fragment,null,React.createElement(G,{className:"mr-2"})," Mark as Responded")))))),React.createElement("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse"},React.createElement("button",{type:"button",className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm",onClick:()=>i(!1)},"Close"),React.createElement("a",{href:`mailto:${r.email}?subject=Re: ${r.subject}`,className:"mt-3 mr-2 w-full inline-flex justify-center rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:mt-0 sm:w-auto sm:text-sm"},"Reply via Email"))))))}const K="data:image/png;base64,";function Z({setUser:o}){const[d,N]=a.useState({email:"",password:""}),[h,u]=a.useState(""),[l,r]=a.useState(!1),t=i=>{N({...d,[i.target.name]:i.target.value})},n=async i=>{i.preventDefault(),u(""),r(!0);try{const b=await(await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(d),credentials:"include"})).json();b.success?o(b.user):u(b.message||"Login failed")}catch(m){console.error("Login error:",m),u("Failed to connect to the server. Please try again.")}finally{r(!1)}};return React.createElement("div",{className:"min-h-screen flex items-center justify-center bg-gray-100 py-12 px-4 sm:px-6 lg:px-8"},React.createElement("div",{className:"max-w-md w-full space-y-8 bg-white p-8 rounded-lg shadow-md"},React.createElement("div",{className:"text-center"},React.createElement("img",{src:K,alt:"Royal Mark Academy Logo",className:"mx-auto h-20 w-auto",onError:i=>{i.target.onerror=null,i.target.src="https://placehold.co/200x80?text=Royal+Mark+Academy"}}),React.createElement("h2",{className:"mt-6 text-3xl font-extrabold text-blue-900"},"Admin Login"),React.createElement("p",{className:"mt-2 text-sm text-gray-600"},"Royal Mark Academy Staff Portal")),h&&React.createElement("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4"},React.createElement("div",{className:"flex items-center"},React.createElement(M,{className:"text-red-500 mr-2"}),React.createElement("p",{className:"text-red-700 text-sm"},h))),React.createElement("form",{className:"mt-8 space-y-6",onSubmit:n},React.createElement("div",{className:"rounded-md shadow-sm -space-y-px"},React.createElement("div",{className:"mb-4"},React.createElement("label",{htmlFor:"email",className:"sr-only"},"Email address"),React.createElement("div",{className:"relative"},React.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},React.createElement(U,{className:"h-5 w-5 text-gray-400"})),React.createElement("input",{id:"email",name:"email",type:"email",autoComplete:"email",required:!0,value:d.email,onChange:t,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Email address",disabled:l}))),React.createElement("div",null,React.createElement("label",{htmlFor:"password",className:"sr-only"},"Password"),React.createElement("div",{className:"relative"},React.createElement("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},React.createElement(I,{className:"h-5 w-5 text-gray-400"})),React.createElement("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:d.password,onChange:t,className:"block w-full pl-10 pr-3 py-2 border border-gray-300 rounded-md leading-5 bg-white placeholder-gray-500 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Password",disabled:l})))),React.createElement("div",null,React.createElement("button",{type:"submit",disabled:l,className:`group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-800 hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${l?"opacity-70 cursor-not-allowed":""}`},l?React.createElement(React.Fragment,null,React.createElement("span",{className:"absolute left-0 inset-y-0 flex items-center pl-3"},React.createElement("div",{className:"animate-spin h-4 w-4 border-2 border-white border-t-transparent rounded-full"})),"Signing in..."):"Sign in"))),React.createElement("p",{className:"mt-2 text-center text-sm text-gray-600"},"Return to ",React.createElement("a",{href:"/",className:"font-medium text-blue-800 hover:text-blue-900"},"School Website"))))}function ee(){const[o,d]=a.useState([]),[N,h]=a.useState(!0),[u,l]=a.useState(""),[r,t]=a.useState(!1),[n,i]=a.useState({name:"",email:"",password:"",role:"staff"}),[m,b]=a.useState({}),[g,S]=a.useState(!1);a.useEffect(()=>{(async()=>{try{const x=await(await fetch("/api/auth/users",{credentials:"include"})).json();x.success?d(x.data||[]):l(x.message||"Failed to fetch users")}catch(f){console.error("Error fetching users:",f),l("Failed to connect to the server")}finally{h(!1)}})()},[]);const w=c=>{const{name:f,value:x}=c.target;i({...n,[f]:x}),m[f]&&b({...m,[f]:""})},E=()=>{const c={};return n.name.trim()||(c.name="Name is required"),n.email.trim()?/\S+@\S+\.\S+/.test(n.email)||(c.email="Email is invalid"):c.email="Email is required",n.password.trim()?n.password.length<6&&(c.password="Password must be at least 6 characters"):c.password="Password is required",c},C=async c=>{c.preventDefault();const f=E();if(Object.keys(f).length>0){b(f);return}S(!0);try{const v=await(await fetch("/api/auth/create-staff",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n),credentials:"include"})).json();v.success?(d([...o,v.user]),i({name:"",email:"",password:"",role:"staff"}),t(!1)):l(v.message||"Failed to create user")}catch(x){console.error("Error creating user:",x),l("Failed to connect to the server")}finally{S(!1)}};return N?React.createElement("div",{className:"flex justify-center items-center py-10"},React.createElement("div",{className:"animate-spin rounded-full h-10 w-10 border-t-2 border-b-2 border-blue-800"})):React.createElement("div",null,React.createElement("div",{className:"flex justify-between items-center mb-6"},React.createElement("h2",{className:"text-xl font-bold text-gray-800"},"User Management"),React.createElement("button",{onClick:()=>t(!0),className:"px-4 py-2 bg-blue-800 text-white rounded-md hover:bg-blue-900 flex items-center"},React.createElement(q,{className:"mr-2"})," Add User")),u&&React.createElement("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 mb-4"},React.createElement("div",{className:"flex items-center"},React.createElement(M,{className:"text-red-500 mr-2"}),React.createElement("p",{className:"text-red-700"},u))),React.createElement("div",{className:"overflow-x-auto"},React.createElement("table",{className:"min-w-full divide-y divide-gray-200"},React.createElement("thead",{className:"bg-gray-50"},React.createElement("tr",null,React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Name"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Email"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Role"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},"Last Login"),React.createElement("th",{scope:"col",className:"px-4 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider"},"Actions"))),React.createElement("tbody",{className:"bg-white divide-y divide-gray-200"},o.length===0?React.createElement("tr",null,React.createElement("td",{colSpan:"5",className:"px-4 py-3 text-center text-sm text-gray-500"},"No users found. Add a new user to get started.")):o.map(c=>React.createElement("tr",{key:c.id,className:"hover:bg-gray-50"},React.createElement("td",{className:"px-4 py-3 whitespace-nowrap"},React.createElement("div",{className:"flex items-center"},React.createElement("div",{className:"flex-shrink-0 h-8 w-8"},c.profileImage?React.createElement("img",{className:"h-8 w-8 rounded-full",src:c.profileImage,alt:""}):React.createElement("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center"},React.createElement(L,{className:"text-blue-800"}))),React.createElement("div",{className:"ml-4"},React.createElement("div",{className:"text-sm font-medium text-gray-900"},c.name)))),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500"},c.email),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap"},React.createElement("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${c.role==="admin"?"bg-purple-100 text-purple-800":"bg-blue-100 text-blue-800"}`},c.role)),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-sm text-gray-500"},c.lastLogin?new Date(c.lastLogin).toLocaleString():"Never"),React.createElement("td",{className:"px-4 py-3 whitespace-nowrap text-right text-sm font-medium"},React.createElement("button",{className:"text-blue-600 hover:text-blue-900 mr-3",title:"Edit user"},React.createElement(V,null)),React.createElement("button",{className:"text-red-600 hover:text-red-900",title:"Delete user"},React.createElement(z,null)))))))),r&&React.createElement("div",{className:"fixed inset-0 z-50 overflow-y-auto","aria-labelledby":"modal-title",role:"dialog","aria-modal":"true"},React.createElement("div",{className:"flex items-end justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0"},React.createElement("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity","aria-hidden":"true",onClick:()=>t(!1)}),React.createElement("span",{className:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"​"),React.createElement("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full"},React.createElement("div",{className:"absolute top-0 right-0 pt-4 pr-4"},React.createElement("button",{type:"button",className:"bg-white rounded-md text-gray-400 hover:text-gray-500 focus:outline-none",onClick:()=>t(!1)},React.createElement("span",{className:"sr-only"},"Close"),React.createElement(H,{className:"h-5 w-5"}))),React.createElement("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4"},React.createElement("h3",{className:"text-lg leading-6 font-medium text-gray-900 mb-4",id:"modal-title"},"Add New User"),React.createElement("form",{onSubmit:C},React.createElement("div",{className:"mb-4"},React.createElement("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700"},"Name"),React.createElement("input",{type:"text",name:"name",id:"name",value:n.name,onChange:w,className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${m.name?"border-red-500":"border-gray-300"}`}),m.name&&React.createElement("p",{className:"mt-1 text-sm text-red-600"},m.name)),React.createElement("div",{className:"mb-4"},React.createElement("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700"},"Email"),React.createElement("input",{type:"email",name:"email",id:"email",value:n.email,onChange:w,className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${m.email?"border-red-500":"border-gray-300"}`}),m.email&&React.createElement("p",{className:"mt-1 text-sm text-red-600"},m.email)),React.createElement("div",{className:"mb-4"},React.createElement("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700"},"Password"),React.createElement("input",{type:"password",name:"password",id:"password",value:n.password,onChange:w,className:`mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-blue-500 focus:border-blue-500 sm:text-sm ${m.password?"border-red-500":"border-gray-300"}`}),m.password&&React.createElement("p",{className:"mt-1 text-sm text-red-600"},m.password)),React.createElement("div",{className:"mb-4"},React.createElement("label",{htmlFor:"role",className:"block text-sm font-medium text-gray-700"},"Role"),React.createElement("select",{id:"role",name:"role",value:n.role,onChange:w,className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm rounded-md"},React.createElement("option",{value:"staff"},"Staff"),React.createElement("option",{value:"admin"},"Administrator"))),React.createElement("div",{className:"pt-4 border-t border-gray-200"},React.createElement("button",{type:"submit",disabled:g,className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-800 hover:bg-blue-900 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${g?"opacity-70 cursor-not-allowed":""}`},g?React.createElement(React.Fragment,null,React.createElement("span",{className:"animate-spin mr-2"},"⟳")," Creating..."):"Create User"))))))))}function ae(){const[o,d]=a.useState(null),[N,h]=a.useState(!0),[u,l]=a.useState("applications");a.useEffect(()=>{(async()=>{try{const i=await(await fetch("/api/auth/me",{credentials:"include"})).json();i.success&&d(i.data)}catch(n){console.error("Auth check error:",n)}finally{h(!1)}})()},[]);const r=async()=>{try{await fetch("/api/auth/logout",{credentials:"include"}),d(null)}catch(t){console.error("Logout error:",t)}};return N?React.createElement("div",{className:"min-h-screen flex justify-center items-center bg-gray-100"},React.createElement("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-800"})):o?React.createElement("div",{className:"bg-gray-100 min-h-screen"},React.createElement("div",{className:"bg-white shadow-md"},React.createElement("div",{className:"container mx-auto px-4 py-4 flex justify-between items-center"},React.createElement("h1",{className:"text-2xl font-bold text-blue-900"},"Royal Mark Academy Admin"),React.createElement("div",{className:"flex items-center"},React.createElement("div",{className:"mr-4 text-sm text-gray-600"},React.createElement("span",{className:"flex items-center"},React.createElement(L,{className:"mr-1"}),o.name," | ",o.role),React.createElement("span",{className:"flex items-center text-xs"},React.createElement(U,{className:"mr-1"}),o.email)),React.createElement("button",{onClick:r,className:"flex items-center px-3 py-1 bg-gray-200 hover:bg-gray-300 rounded text-sm"},React.createElement(J,{className:"mr-1"})," Logout")))),React.createElement("div",{className:"container mx-auto px-4 py-6"},React.createElement("div",{className:"mb-6 flex border-b border-gray-300"},React.createElement("button",{onClick:()=>l("applications"),className:`px-4 py-2 flex items-center ${u==="applications"?"border-b-2 border-blue-800 text-blue-800":"text-gray-600"}`},React.createElement(W,{className:"mr-2"})," Applications"),React.createElement("button",{onClick:()=>l("contacts"),className:`px-4 py-2 flex items-center ${u==="contacts"?"border-b-2 border-blue-800 text-blue-800":"text-gray-600"}`},React.createElement(Q,{className:"mr-2"})," Contact Messages"),o.role==="admin"&&React.createElement("button",{onClick:()=>l("users"),className:`px-4 py-2 flex items-center ${u==="users"?"border-b-2 border-blue-800 text-blue-800":"text-gray-600"}`},React.createElement(L,{className:"mr-2"})," Manage Users")),React.createElement("div",{className:"bg-white rounded-lg shadow-md p-6"},u==="applications"&&React.createElement(X,{userRole:o.role}),u==="contacts"&&React.createElement(Y,null),u==="users"&&o.role==="admin"&&React.createElement(ee,null)))):React.createElement(Z,{setUser:d})}export{ae as default};
